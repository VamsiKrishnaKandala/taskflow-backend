# ==========================================================
# TaskFlow Pro - Notification Service
# ----------------------------------------------------------
# Service: Notification Service (Reactive)
# Description: Handles delivery, storage, and live streaming
#              of notifications via Server-Sent Events (SSE).
# Tech Stack: Spring Boot 3.5.x, WebFlux, R2DBC, MySQL, Eureka
# ==========================================================


# ----------------------------------------------------------
# BASIC APPLICATION CONFIG
# ----------------------------------------------------------
spring.application.name=notification-service

# The port where this microservice runs locally
server.port=8084


# ----------------------------------------------------------
# DATABASE CONFIGURATION (R2DBC + MySQL)
# ----------------------------------------------------------
# \u2705 Correct R2DBC format with connection pooling
# Format: r2dbc:pool:mysql://<username>:<password>@<host>:<port>/<database>
spring.r2dbc.url=r2dbc:pool:mysql://root:root@localhost:3306/taskflow_projectdb

spring.r2dbc.username=root
spring.r2dbc.password=root

# SQL schema & data initialization
spring.sql.init.mode=always
spring.sql.init.platform=mysql
spring.sql.init.encoding=UTF-8
spring.sql.init.schema-locations=classpath:schema.sql
spring.sql.init.data-locations=classpath:data.sql
spring.sql.init.continue-on-error=true


# ----------------------------------------------------------
# EUREKA CLIENT CONFIGURATION
# ----------------------------------------------------------
# URL of the Eureka Server
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/

# Enable Eureka registration
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true

# Instance configuration for Eureka Dashboard
eureka.instance.instance-id=${spring.application.name}:${server.port}
eureka.instance.prefer-ip-address=true


# ----------------------------------------------------------
# WEBCLIENT CONFIGURATION (INTER-SERVICE COMMUNICATION)
# ----------------------------------------------------------
# URLs for other microservices (direct HTTP/WebClient)
task.service.url=http://localhost:8082/api/v1/tasks
user.service.url=http://localhost:8083/api/v1/users
project.service.url=http://localhost:8081/api/v1/projects


# ----------------------------------------------------------
# NOTIFICATION SERVICE CONFIG
# ----------------------------------------------------------
# Enable reactive event streaming (SSE)
spring.webflux.base-path=/api/v1
notification.stream.buffer-size=100
notification.replay.enabled=true

# SSE connection timeout
server.reactive.session.timeout=30m


# ----------------------------------------------------------
# LOGGING CONFIGURATION
# ----------------------------------------------------------
logging.level.root=INFO
logging.level.com.taskflowpro.notificationservice=DEBUG

# Custom console log pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %5p [%t] --- %c{1}: %m%n


# ----------------------------------------------------------
# JACKSON (JSON SERIALIZATION)
# ----------------------------------------------------------
spring.jackson.serialization.indent_output=true
spring.jackson.time-zone=Asia/Kolkata
spring.webflux.charset=UTF-8


# ----------------------------------------------------------
# DEVTOOLS (Optional Auto Restart / Live Reload)
# ----------------------------------------------------------
spring.devtools.livereload.enabled=true
spring.devtools.restart.enabled=true


# ----------------------------------------------------------
# ACTUATOR (Optional Monitoring)
# ----------------------------------------------------------
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always


# ----------------------------------------------------------
# REACTOR DEBUG (Reactive stack traces)
# ----------------------------------------------------------
reactor.debug-agent.enabled=true

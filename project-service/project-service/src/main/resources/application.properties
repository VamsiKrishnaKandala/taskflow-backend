# ==========================================================
# TaskFlow Pro - Project Service
# ----------------------------------------------------------
# Service: Project Service (Reactive)
# Description: Handles CRUD operations for projects.
# Tech Stack: Spring Boot 3.5.x, WebFlux, R2DBC, MySQL, Eureka
# ==========================================================


# ----------------------------------------------------------
# BASIC APPLICATION CONFIG
# ----------------------------------------------------------
spring.application.name=project-service

# The port where this microservice runs locally
server.port=8081


# ----------------------------------------------------------
# DATABASE CONFIGURATION (R2DBC + MySQL)
# ----------------------------------------------------------
# \u2705 Correct format for R2DBC URL (with connection pool)
# Format: r2dbc:pool:mysql://<username>:<password>@<host>:<port>/<database>

spring.r2dbc.url=r2dbc:pool:mysql://root:root@localhost:3306/taskflow_projectdb

# Note: These are not always used for R2DBC pooled connections, 
# but safe to define explicitly
spring.r2dbc.username=root
spring.r2dbc.password=root

# \u2705 Enable SQL schema and data initialization
spring.sql.init.mode=always
spring.sql.init.platform=mysql
spring.sql.init.encoding=UTF-8
spring.sql.init.schema-locations=classpath:schema.sql
spring.sql.init.data-locations=classpath:data.sql

# \u2705 Ensures schema.sql and data.sql are applied before app starts
spring.sql.init.continue-on-error=true


# ----------------------------------------------------------
# EUREKA CLIENT CONFIGURATION
# ----------------------------------------------------------
# URL of the Eureka Server
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/

# Enable Eureka registration
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true

# Instance configuration for Eureka Dashboard
eureka.instance.instance-id=${spring.application.name}:${server.port}
eureka.instance.prefer-ip-address=true


# ----------------------------------------------------------
# LOGGING CONFIGURATION
# ----------------------------------------------------------
# Set base log level
logging.level.root=INFO

# Enable DEBUG logs for your service package
logging.level.com.taskflowpro.projectservice=DEBUG

# Custom console log pattern (timestamp, level, thread, logger, message)
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %5p [%t] --- %c{1}: %m%n


# ----------------------------------------------------------
# WEBFLUX CONFIGURATION
# ----------------------------------------------------------
# Base API path (helps when using an API Gateway)
spring.webflux.base-path=/api/v1/projects

# Reactive session timeout
server.reactive.session.timeout=30m


# ----------------------------------------------------------
# VALIDATION CONFIGURATION
# ----------------------------------------------------------
# Ensures WebFlux reactive validation is enabled
spring.main.web-application-type=reactive
spring.validation.enabled=true


# ----------------------------------------------------------
# DEVTOOLS (Auto Restart / Live Reload)
# ----------------------------------------------------------
spring.devtools.livereload.enabled=true
spring.devtools.restart.enabled=true


# ----------------------------------------------------------
# TEST DATABASE (Optional for Local Development)
# ----------------------------------------------------------
# Uncomment below line if you use a separate DB for tests
# spring.r2dbc.url=r2dbc:pool:mysql://root:password@localhost:3306/taskflow_projectdb_test